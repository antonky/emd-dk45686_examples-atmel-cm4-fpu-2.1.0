<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DK45686 eMD examples User Guide: edmp_apex</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="TDK_theme.css" rel="stylesheet" type="text/css"/>
<link href="TDK_override_banner_color.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="TDK_Logo_white.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DK45686 eMD examples User Guide
   &#160;<span id="projectnumber">2.1.0</span>
   </div>
   <div id="projectbrief">Documentation of the DK45686 eMD examples</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('a00052.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">edmp_apex </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This application demonstrates how to configure and use APEX features.</p>
<p>It allows enabling individually pedometer, SMD, tilt, raise-to-wake, tap and freefall (including lowGee and highGee) eDMP features. Any APEX feature update is notified through INT1. Power save mode can be selected and works in addition with Wake On Motion (WOM) to wake up eDMP only when motion is detected.</p>
<p>It automatically enables accelerometer at appropriate frequency and in optimal power mode depending on requested feature combination.</p>
<p>At startup, all features are enabled by default so accel is enabled in Low-Noise at 800Hz.</p>
<h1><a class="anchor" id="autotoc_md45"></a>
Command interface</h1>
<p>This application allows the following command to be sent through UART:</p><ul>
<li><code>p</code>: to enable/disable pedometer feature (defaults to enable).</li>
<li><code>s</code>: to enable/disable SMD feature (defaults to enable).</li>
<li><code>t</code>: to enable/disable Tilt feature (defaults to enable).</li>
<li><code>r</code>: to enable/disable Raise-To-Wake feature (defaults to enable).</li>
<li><code>a</code>: to enable/disable Tap feature (defaults to enable).</li>
<li><code>f</code>: to enable/disable Freefall feature (defaults to enable).</li>
<li><code>l</code>: to enable/disable LowGee feature (defaults to enable).</li>
<li><code>i</code>: to enable/disable HighGee feature (defaults to enable).</li>
<li><code>o</code>: to enable/disable Power save mode (defaults to disable).</li>
<li><code>c</code>: to print current configuration.</li>
<li><code>h</code>: to print help screen.</li>
</ul>
<p>Accel is enabled at 50Hz or 100Hz in Low-Power mode or at 800Hz in Low-Noise mode depending on features requested to achieve optimal power consumption.</p>
<h1><a class="anchor" id="autotoc_md46"></a>
Terminal output</h1>
<h2><a class="anchor" id="autotoc_md47"></a>
Data format</h2>
<p>Data are printed on the terminal as follow:</p>
<p>For all cases, <code>&lt;timestamp&gt;</code> is the time in microsecond read from MCU clock.</p>
<h3><a class="anchor" id="autotoc_md48"></a>
Pedometer event</h3>
<div class="fragment"><div class="line">&lt;timestamp&gt; us   STEP_DET count: &lt;step_count&gt; steps cadence: &lt;cadence&gt; steps/s activity: &lt;activity_class&gt;</div>
</div><!-- fragment --><p>With:</p><ul>
<li><code>&lt;step_count&gt;</code>: Number of steps as reported by eDMP</li>
<li><code>&lt;cadence&gt;</code>: Number of steps per second</li>
<li><code>&lt;activity_class&gt;</code>: Type of activity detected (Run, Walk, Unknown)</li>
</ul>
<p><b>Note:</b> Step count and cadence are valid only once the step count starts incrementing. <code>&lt;activity_class&gt;</code> will remain <em>Unknown</em> meanwhile.</p>
<h3><a class="anchor" id="autotoc_md49"></a>
SMD event</h3>
<div class="fragment"><div class="line">&lt;timestamp&gt; us   SMD</div>
</div><!-- fragment --><p>Once the example is running, the user shall simulate a displacement to generate a SMD. A displacement is typically simulated by doing "steps" (moving the board up and down for ~8 sec).</p>
<h3><a class="anchor" id="autotoc_md50"></a>
Tilt event</h3>
<div class="fragment"><div class="line">&lt;timestamp&gt; us   TILT</div>
</div><!-- fragment --><p>Once the example is running, tilting the board with an angle of 30 degrees or more will generate a tilt. By default, a tilt event is generated when the position is held for 4 seconds.</p>
<h3><a class="anchor" id="autotoc_md51"></a>
Raise-To-Wake event</h3>
<div class="fragment"><div class="line">&lt;timestamp&gt; us   R2W_WAKE</div>
<div class="line">&lt;timestamp&gt; us   R2W_SLEEP</div>
</div><!-- fragment --><p>Considering a device with screen, a <code>R2W_WAKE</code> event is fired when the user looks at the screen. A <code>R2W_SLEEP</code> event is fired when the device is put back on the table, or after a time out.</p>
<p>A mounting matrix can be configured with <code>apex_parameters.r2w_mounting_matrix</code> (default to 0). Please refer to the following picture to identify how to set the mounting matrix, depending on the IMU reference frame, so the 'WAKE' interrupt is fired when user looks at the screen.</p>
<p><img src="r2w_mmatrix.png" alt="" class="inline"/></p>
<p><b>Note:</b> The default value for the <code>r2w_sleep_time_out</code> parameter is 64 which corresponds to a delay of 0.64 s. As implemented in this example, it is advised to change it to 6400 which corresponds to a delay of 6.4 s.</p>
<h3><a class="anchor" id="autotoc_md52"></a>
Tap event</h3>
<div class="fragment"><div class="line">&lt;timestamp&gt; us   TAP Single Direction: &lt;axis&gt; &lt;sign&gt;</div>
<div class="line">&lt;timestamp&gt; us   TAP Double Direction: &lt;axis&gt; &lt;sign&gt; duration: &lt;duration&gt; us</div>
</div><!-- fragment --><p>With:</p><ul>
<li><code>&lt;axis&gt;</code>: X or Y or Z</li>
<li><code>&lt;sign&gt;</code>: + or -</li>
<li><code>&lt;duration&gt;</code>: Double tap duration in us</li>
</ul>
<p>In case of double tap on different axis, the axis reported is the first axis impacted.</p>
<h3><a class="anchor" id="autotoc_md53"></a>
Freefall event</h3>
<div class="fragment"><div class="line">&lt;timestamp&gt; us   FREEFALL duration: &lt;sample_count&gt; samples (&lt;duration&gt; ms)</div>
</div><!-- fragment --><p>With:</p><ul>
<li><code>&lt;sample_count&gt;</code>: Number of samples during which freefall occurred</li>
<li><code>&lt;duration&gt;</code>: Freefall duration in ms</li>
</ul>
<p>The freefall feature uses a low-g and a high-g detector to detect freefall beginning and end. When a freefall is detected, an interrupt is triggered and the duration of the fall is printed. The duration is given in number of samples and can be converted to a distance with the following formula:</p>
<p>𝐹𝐹𝑑𝑖𝑠𝑡𝑎𝑛𝑐𝑒=9.81×(𝐹𝐹𝑑𝑢𝑟𝑎𝑡𝑖𝑜𝑛×e𝐷𝑀𝑃_𝑂𝐷𝑅𝑠𝑒𝑐)²/2</p>
<h3><a class="anchor" id="autotoc_md54"></a>
LowG event</h3>
<div class="fragment"><div class="line">&lt;timestamp&gt; us   LOW_G</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md55"></a>
HighG event</h3>
<div class="fragment"><div class="line">&lt;timestamp&gt; us   HIGH_G</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md56"></a>
Example of output</h2>
<div class="fragment"><div class="line">[I] ###</div>
<div class="line">[I] ### Example EDMP APEX</div>
<div class="line">[I] ###</div>
<div class="line">[I] #</div>
<div class="line">[I] # Current configuration</div>
<div class="line">[I] #</div>
<div class="line">[I] # Pedometer: Enabled</div>
<div class="line">[I] # SMD: Enabled</div>
<div class="line">[I] # Tilt: Enabled</div>
<div class="line">[I] # R2W: Enabled</div>
<div class="line">[I] # Tap: Enabled</div>
<div class="line">[I] # Freefall: Enabled</div>
<div class="line">[I] # LowG: Enabled</div>
<div class="line">[I] # HighG: Enabled</div>
<div class="line">[I] #</div>
<div class="line">[I] # ODR: 800 Hz</div>
<div class="line">[I] #</div>
<div class="line">[I]       4620412 us   STEP_DET     count:     0 steps   cadence: 2.0 steps/s   activity: Unknown</div>
<div class="line">[I]       4979164 us   STEP_DET     count:     0 steps   cadence: 2.0 steps/s   activity: Unknown</div>
<div class="line">[I]       5357850 us   STEP_DET     count:     6 steps   cadence: 2.0 steps/s   activity: Unknown</div>
<div class="line">[I]       5696635 us   STEP_DET     count:     7 steps   cadence: 2.1 steps/s   activity: Walk</div>
<div class="line">[I]       6095235 us   STEP_DET     count:     8 steps   cadence: 2.2 steps/s   activity: Walk</div>
<div class="line">[I]       6414138 us   SMD</div>
<div class="line">[I]       6509453 us   TAP     Single   Direction: Y+</div>
<div class="line">[I]       6553624 us   STEP_DET     count:     9 steps   cadence: 2.2 steps/s   activity: Walk</div>
<div class="line">[I]      21164854 us   R2W_WAKE</div>
<div class="line">[I]      21364171 us   R2W_SLEEP</div>
<div class="line">[I]      23676232 us   TAP     Single   Direction: Z-</div>
<div class="line">[I]      32908480 us   TAP     Single   Direction: Y+</div>
<div class="line">[I]      33567373 us   TAP     Single   Direction: Y-</div>
<div class="line">[I]      34375739 us   TAP     Double   Direction: Y+   duration: 28750 us</div>
<div class="line">[I]      35257572 us   TAP     Single   Direction: Y+</div>
<div class="line">[I]      36534350 us   TAP     Single   Direction: X-</div>
<div class="line">[I]      37622990 us   TAP     Single   Direction: X-</div>
<div class="line">[I]      41207823 us   TAP     Single   Direction: Z+</div>
<div class="line">[I]      56022468 us   TILT</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Jul 25 2024 08:14:38 for DK45686 eMD examples User Guide by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
